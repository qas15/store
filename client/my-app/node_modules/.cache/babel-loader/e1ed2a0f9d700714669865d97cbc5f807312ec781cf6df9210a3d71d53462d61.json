{"ast":null,"code":"import React,{useState,useEffect}from'react';import\"../styles/AdminOrders.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminOrders=()=>{const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{fetchOrders();},[]);const fetchOrders=async()=>{try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"api/orders\"));if(!response.ok){throw new Error('Ошибка на сервере');}const data=await response.json();setOrders(Array.isArray(data)?data:[]);}catch(error){console.error('Ошибка при загрузке заказов:',error);setError(error.message||'Что-то пошло не так');}finally{setLoading(false);}};const completeOrder=async orderId=>{try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"api/orders/\").concat(orderId),{method:'DELETE'});if(!response.ok){throw new Error('Не удалось выполнить заказ');}setOrders(orders.filter(order=>order.id!==orderId));alert('Заказ доставлен и удалён!');}catch(error){console.error('Ошибка при выполнении заказа:',error);alert('Ошибка при удалении заказа');}};if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \",error]});return/*#__PURE__*/_jsx(\"div\",{className:\"orders-container\",children:orders.map(order=>{var _order$orderDevices;return/*#__PURE__*/_jsxs(\"div\",{className:\"order\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"\\u0417\\u0430\\u043A\\u0430\\u0437 ID: \",order.id]}),/*#__PURE__*/_jsxs(\"p\",{className:\"total-price\",children:[\"\\u041E\\u0431\\u0449\\u0430\\u044F \\u0441\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C: \",order.totalPrice,\"\\u20BD\"]}),order.address?/*#__PURE__*/_jsxs(\"div\",{className:\"address\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C Email: \",/*#__PURE__*/_jsx(\"span\",{children:order.user.email})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0410\\u0434\\u0440\\u0435\\u0441: \",/*#__PURE__*/_jsx(\"span\",{children:order.address.address})]})]}):/*#__PURE__*/_jsx(\"p\",{className:\"no-address\",children:\"\\u0410\\u0434\\u0440\\u0435\\u0441 \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-devices\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u0423\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0430:\"}),/*#__PURE__*/_jsx(\"ul\",{children:(_order$orderDevices=order.orderDevices)===null||_order$orderDevices===void 0?void 0:_order$orderDevices.map(orderDevice=>/*#__PURE__*/_jsx(\"li\",{children:orderDevice.device.name},orderDevice.id))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>completeOrder(order.id),className:\"complete-order\",children:\"\\u0412\\u044B\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"})]},order.id);})});};export default AdminOrders;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","AdminOrders","orders","setOrders","loading","setLoading","error","setError","fetchOrders","response","fetch","concat","process","env","REACT_APP_API_URL","ok","Error","data","json","Array","isArray","console","message","completeOrder","orderId","method","filter","order","id","alert","children","className","map","_order$orderDevices","totalPrice","address","user","email","orderDevices","orderDevice","device","name","onClick"],"sources":["/home/cracker1/Desktop/store/client/my-app/src/pages/AdminOrders.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport \"../styles/AdminOrders.css\";\r\n\r\nconst AdminOrders = () => {\r\n    const [orders, setOrders] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        fetchOrders();\r\n    }, []);\r\n\r\n    const fetchOrders = async () => {\r\n        try {\r\n            const response = await fetch(`${process.env.REACT_APP_API_URL}api/orders`);\r\n            if (!response.ok) {\r\n                throw new Error('Ошибка на сервере');\r\n            }\r\n            const data = await response.json();\r\n            setOrders(Array.isArray(data) ? data : []);\r\n        } catch (error) {\r\n            console.error('Ошибка при загрузке заказов:', error);\r\n            setError(error.message || 'Что-то пошло не так');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const completeOrder = async (orderId) => {\r\n        try {\r\n            const response = await fetch(`${process.env.REACT_APP_API_URL}api/orders/${orderId}`, {\r\n                method: 'DELETE',\r\n            });\r\n            if (!response.ok) {\r\n                throw new Error('Не удалось выполнить заказ');\r\n            }\r\n            setOrders(orders.filter(order => order.id !== orderId));\r\n            alert('Заказ доставлен и удалён!');\r\n        } catch (error) {\r\n            console.error('Ошибка при выполнении заказа:', error);\r\n            alert('Ошибка при удалении заказа');\r\n        }\r\n    };\r\n\r\n    if (loading) return <div>Загрузка...</div>;\r\n    if (error) return <div>Ошибка: {error}</div>;\r\n\r\n    return (\r\n        <div className=\"orders-container\">\r\n            {orders.map((order) => (\r\n                <div key={order.id} className=\"order\">\r\n                    <h3>Заказ ID: {order.id}</h3>\r\n                    <p className=\"total-price\">Общая стоимость: {order.totalPrice}₽</p>\r\n                    {order.address ? (\r\n                        <div className=\"address\">\r\n                            <p>Пользователь Email: <span>{order.user.email}</span></p>\r\n                            <p>Адрес: <span>{order.address.address}</span></p>\r\n                        </div>\r\n                    ) : (\r\n                        <p className=\"no-address\">Адрес не найден</p>\r\n                    )}\r\n                    <div className=\"order-devices\">\r\n                        <h4>Устройства:</h4>\r\n                        <ul>\r\n                            {order.orderDevices?.map((orderDevice) => (\r\n                                <li key={orderDevice.id}>{orderDevice.device.name}</li>\r\n                            ))}\r\n                        </ul>\r\n                    </div>\r\n                    <button onClick={() => completeOrder(order.id)} className=\"complete-order\">Выполнить заказ</button>\r\n                </div>\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AdminOrders;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}