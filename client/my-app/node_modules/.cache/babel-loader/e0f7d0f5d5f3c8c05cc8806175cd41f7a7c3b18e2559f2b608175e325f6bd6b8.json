{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import{BrowserRouter}from\"react-router-dom\";import AppRouter from\"./components/AppRouter\";import NavBar from'./components/NavBar';import{observer}from\"mobx-react-lite\";import{Context}from\"./index\";import{check}from\"./http/userAPI\";import{Spinner}from\"react-bootstrap\";import{BasketProvider}from'./context/BasketContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=observer(()=>{const{user}=useContext(Context);const[loading,setLoading]=useState(true);useEffect(()=>{const token=localStorage.getItem('token');if(token){check().then(data=>{console.log(\"Ответ сервера в check():\",data);if(data){user.setUser(data);user.setIsAuth(true);}else{user.setUser({});user.setIsAuth(false);}}).catch(()=>{user.setUser({});user.setIsAuth(false);localStorage.removeItem(\"token\");}).finally(()=>setLoading(false));}else{user.setUser({});user.setIsAuth(false);setLoading(false);}},[user]);if(loading){return/*#__PURE__*/_jsx(Spinner,{animation:'grow'});}return/*#__PURE__*/_jsx(BasketProvider,{children:/*#__PURE__*/_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsx(AppRouter,{})]})});});export default App;","map":{"version":3,"names":["React","useContext","useEffect","useState","BrowserRouter","AppRouter","NavBar","observer","Context","check","Spinner","BasketProvider","jsx","_jsx","jsxs","_jsxs","App","user","loading","setLoading","token","localStorage","getItem","then","data","console","log","setUser","setIsAuth","catch","removeItem","finally","animation","children"],"sources":["/home/cracker1/Desktop/store/client/my-app/src/App.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport { BrowserRouter } from \"react-router-dom\";\nimport AppRouter from \"./components/AppRouter\";\nimport NavBar from './components/NavBar';\nimport { observer } from \"mobx-react-lite\";\nimport { Context } from \"./index\";\nimport { check } from \"./http/userAPI\";\nimport { Spinner } from \"react-bootstrap\";\nimport { BasketProvider } from './context/BasketContext';\n\nconst App = observer(() => {\n    const { user } = useContext(Context);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        const token = localStorage.getItem('token');\n\n        if (token) {\n            check()\n                .then(data => {\n                    console.log(\"Ответ сервера в check():\", data);\n                    if (data) {\n                        user.setUser(data);\n                        user.setIsAuth(true);\n                    } else {\n                        user.setUser({});\n                        user.setIsAuth(false);\n                    }\n                })\n                .catch(() => {\n                    user.setUser({});\n                    user.setIsAuth(false);\n                    localStorage.removeItem(\"token\");\n                })\n                .finally(() => setLoading(false));\n        } else {\n            user.setUser({});\n            user.setIsAuth(false);\n            setLoading(false);\n        }\n    }, [user]);\n\n    if (loading) {\n        return <Spinner animation={'grow'} />;\n    }\n\n    return (\n        <BasketProvider>\n            <BrowserRouter>\n                <NavBar />\n                <AppRouter />\n            </BrowserRouter>\n        </BasketProvider>\n    );\n});\n\nexport default App;\n\n\n\n\n\n\n\n\n\n\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC9D,OAASC,aAAa,KAAQ,kBAAkB,CAChD,MAAO,CAAAC,SAAS,KAAM,wBAAwB,CAC9C,MAAO,CAAAC,MAAM,KAAM,qBAAqB,CACxC,OAASC,QAAQ,KAAQ,iBAAiB,CAC1C,OAASC,OAAO,KAAQ,SAAS,CACjC,OAASC,KAAK,KAAQ,gBAAgB,CACtC,OAASC,OAAO,KAAQ,iBAAiB,CACzC,OAASC,cAAc,KAAQ,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEzD,KAAM,CAAAC,GAAG,CAAGT,QAAQ,CAAC,IAAM,CACvB,KAAM,CAAEU,IAAK,CAAC,CAAGhB,UAAU,CAACO,OAAO,CAAC,CACpC,KAAM,CAACU,OAAO,CAAEC,UAAU,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAkB,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAIF,KAAK,CAAE,CACPX,KAAK,CAAC,CAAC,CACFc,IAAI,CAACC,IAAI,EAAI,CACVC,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEF,IAAI,CAAC,CAC7C,GAAIA,IAAI,CAAE,CACNP,IAAI,CAACU,OAAO,CAACH,IAAI,CAAC,CAClBP,IAAI,CAACW,SAAS,CAAC,IAAI,CAAC,CACxB,CAAC,IAAM,CACHX,IAAI,CAACU,OAAO,CAAC,CAAC,CAAC,CAAC,CAChBV,IAAI,CAACW,SAAS,CAAC,KAAK,CAAC,CACzB,CACJ,CAAC,CAAC,CACDC,KAAK,CAAC,IAAM,CACTZ,IAAI,CAACU,OAAO,CAAC,CAAC,CAAC,CAAC,CAChBV,IAAI,CAACW,SAAS,CAAC,KAAK,CAAC,CACrBP,YAAY,CAACS,UAAU,CAAC,OAAO,CAAC,CACpC,CAAC,CAAC,CACDC,OAAO,CAAC,IAAMZ,UAAU,CAAC,KAAK,CAAC,CAAC,CACzC,CAAC,IAAM,CACHF,IAAI,CAACU,OAAO,CAAC,CAAC,CAAC,CAAC,CAChBV,IAAI,CAACW,SAAS,CAAC,KAAK,CAAC,CACrBT,UAAU,CAAC,KAAK,CAAC,CACrB,CACJ,CAAC,CAAE,CAACF,IAAI,CAAC,CAAC,CAEV,GAAIC,OAAO,CAAE,CACT,mBAAOL,IAAA,CAACH,OAAO,EAACsB,SAAS,CAAE,MAAO,CAAE,CAAC,CACzC,CAEA,mBACInB,IAAA,CAACF,cAAc,EAAAsB,QAAA,cACXlB,KAAA,CAACX,aAAa,EAAA6B,QAAA,eACVpB,IAAA,CAACP,MAAM,GAAE,CAAC,cACVO,IAAA,CAACR,SAAS,GAAE,CAAC,EACF,CAAC,CACJ,CAAC,CAEzB,CAAC,CAAC,CAEF,cAAe,CAAAW,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}